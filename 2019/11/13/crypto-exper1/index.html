<!DOCTYPE html>
<html>

<head><meta name="generator" content="Hexo 3.9.0">
  
  <title>crypto_exper1 现代密码学实验一 - Hexo</title>
  <meta charset="UTF-8">
  <meta name="description" content>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  

  <link rel="shortcut icon" href="/favicon.ico" type="image/png">
  <meta name="description" content="现代密码学实验一">
<meta name="keywords" content="cryptography,python">
<meta property="og:type" content="article">
<meta property="og:title" content="crypto_exper1 现代密码学实验一">
<meta property="og:url" content="http://yoursite.com/2019/11/13/crypto-exper1/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="现代密码学实验一">
<meta property="og:locale" content="en# ��վʹ�õ�����">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191020012359251.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMDI2MjE5,size_16,color_FFFFFF,t_70">
<meta property="og:updated_time" content="2019-11-13T03:04:19.726Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="crypto_exper1 现代密码学实验一">
<meta name="twitter:description" content="现代密码学实验一">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20191020012359251.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMDI2MjE5,size_16,color_FFFFFF,t_70">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/css/mdui.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.15.8/styles/atom-one-dark.css">
   
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1038733_0xvrvpg9c0r.css">
  <link rel="stylesheet" href="/css/style.css?v=1573616268176">
</head>

<body class="mdui-drawer-body-left">
  
  <div id="nexmoe-background">
    <div class="nexmoe-bg" style="background-image: url(https://i.loli.net/2019/01/13/5c3aec85a4343.jpg)"></div>
    <div class="mdui-appbar mdui-shadow-0">
      <div class="mdui-toolbar">
        <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">menu</i></a>
        <div class="mdui-toolbar-spacer"></div>
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
        <a href="/" title="kmm" class="mdui-btn mdui-btn-icon"><img src="/images/avatar.png"></a>
       </div>
    </div>
  </div>
  <div id="nexmoe-header">
      <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="kmm">
            <img src="/images/avatar.png" alt="kmm">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>Articles</span>9</div>
        <div><span>Tags</span>5</div>
        <div><span>Categories</span>4</div>
    </div>
    <ul class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </ul>
    <aside id="nexmoe-sidebar">
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Social</h3>
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://space.bilibili.com/20238211" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/nexmoe/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Categories</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/cryptography/">cryptography</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/java/">java</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/number-theory/">number theory</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/reverse/">reverse</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Tagcloud</h3>
    <div id="randomtagcloud" class="nexmoe-widget tagcloud">
      <a href="/tags/cryptography/" style="font-size: 20px;">cryptography</a> <a href="/tags/dll/" style="font-size: 10px;">dll</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/信安数基，中国剩余定理/" style="font-size: 10px;">信安数基，中国剩余定理</a>
    </div>
    
  </div>

  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Archive</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li></ul>
    </div>
  </div>


  
</aside>
    <div class="nexmoe-copyright">
        &copy; 2019 kmm
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://nexmoe.com/hexo-theme-nexmoe.html" target="_blank">Nexmoe</a>
    </div>
</div><!-- .nexmoe-drawer -->
  </div>
  <div id="nexmoe-content">
    <div class="nexmoe-primary">
        <div class="nexmoe-post">
    <div class="nexmoe-post-cover"> 
        
            <img src="https://i.loli.net/2019/01/13/5c3aec85a4343.jpg">
        
        <h1>crypto_exper1 现代密码学实验一</h1>
    </div>
  <div class="nexmoe-post-meta">
    <a><i class="nexmoefont icon-calendar-fill"></i>2019年11月13日</a>
    <a><i class="nexmoefont icon-areachart"></i>3.1k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 16 分钟</a>
    
      <a class="nexmoefont icon-appstore-fill -link" href="/categories/cryptography/">cryptography</a>
    
    
      <a class="nexmoefont icon-tag-fill -link" href="/tags/cryptography/">cryptography</a> <a class="nexmoefont icon-tag-fill -link" href="/tags/python/">python</a>
    
  </div>
  <article>
    <!--
---
title: postName #文章页面上的显示名称，一般是中文
date: 2013-12-02 15:30:16 #文章生成时间，一般不改，当然也可以任意修改
categories: 默认分类 #分类
tags: [tag1,tag2,tag3] #文章标签，可空，多标签请用格式，注意:后面有个空格
description: 附加一段文章摘要，字数最好在140字以内，会出现在meta的description里面
---

以下是正文
-->
<h1 id="密码学实验一"><a href="#密码学实验一" class="headerlink" title="密码学实验一"></a>密码学实验一</h1><blockquote>
<p>problem<br>详见内容</p>
</blockquote>
<blockquote>
<p>environment: pycharm python2 or 3</p>
</blockquote>
<a id="more"></a>


<p>@<a href="密码学实验一">TOC</a></p>
<h1 id="现代密码学实验一"><a href="#现代密码学实验一" class="headerlink" title="现代密码学实验一"></a>现代密码学实验一</h1><h2 id="crypto-week1-program-assignment"><a href="#crypto-week1-program-assignment" class="headerlink" title="crypto -week1 program assignment"></a>crypto -week1 program assignment</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><ol>
<li><p>Coursera Dan Boneh Week 1 Program Assignment Many Time Pad</p>
</li>
<li><p>PA1 option<br>Write a program that allows you to “crack” ciphertexts generated using a Vigenere-like cipher, where byte-wise XOR is used instead of addition modulo 26.</p>
</li>
<li><p><a href="http://www.cryptopals.com/sets/1" target="_blank" rel="noopener">http://www.cryptopals.com/sets/1</a></p>
<p>(1)    Convert hex to base64<br>(2)    Fixed XOR<br>(3)    Single-byte XOR cipher<br>(4)    Detect single-character XOR<br>(5)    Implement repeating-key XOR<br>(6)    Break repeating-key XOR</p>
</li>
<li><p>MTC3 Cracking SHA1-Hashed Passwords <a href="https://www.mysterytwisterc3.org/en/challenges/level-2/cracking-sh" target="_blank" rel="noopener">https://www.mysterytwisterc3.org/en/challenges/level-2/cracking-sh</a> a1-hashed-passwords</p>
</li>
</ol>
<h3 id="详情与思路"><a href="#详情与思路" class="headerlink" title="详情与思路"></a>详情与思路</h3><p>题目描述（清楚描述题目中文，写出自己的理解，请勿复制原题目）</p>
<p>1.Coursera Dan Boneh Week 1 Program Assignment Many Time Pad<br>题目大意：有11个同一异或加密流密码密钥加密的密文，尝试解密最后一个密文。</p>
<p>思路：由于使用了同一个密钥异或加密10个明文，导致生成的密文互相异或会得到部分信息，比如空格和小写字母异或将得到大写字母，可以根据空格的位置猜测部分信息</p>
<p>2.PA1 option<br>题目大意：编写一个程序，破解使用维吉尼亚类似密码生成的密文，不过把加密方法变为了异或。<br>思路：由于密钥是两个4位16进制的字符串，并且加密方式位异或，可以通过遍历密钥异或密文判断有效可见明文的数量来确实密钥，得到密钥就可以破解密文。</p>
<p>3． <a href="http://www.cryptopals.com/sets/1" target="_blank" rel="noopener">http://www.cryptopals.com/sets/1</a><br>此url上的前六个问题<br>1）Convert hex to base64<br>题目大意：把16进制字符串转化为base64编码<br>思路：调用python函数即可转化编码</p>
<p>2）Fixed XOR<br>题目大意： 把两个等长的字符串按位进行异或<br>思路： 一个字符单独异或最后转化为新字符串</p>
<p>3）Single-byte XOR cipher<br>题目大意：单个字符进行异或加密。找到密钥，解密消息。<br>思路: 遍历密钥和密文每一位进行解密操作，破译出的可见明文越多那么越可能是密钥</p>
<p>4）Detect single-character XOR<br>题目大意： 单个字符串对txt中的一条明文进行异或加密<br>思路： 同第三题思路不过是要遍历整个txt</p>
<p>5）Implement repeating-key XOR<br>题目大意： 使用ICE三个字符类似维吉尼亚的分组加密字符串破译<br>思路： 按要求分组加密即可</p>
<p>6）Break repeating-key XOR<br>题目大意： 使用平均汉明距离破解密文，加密方法为分组异或<br>思路： 在不同密钥长度将密文的txt分组，取四个分组计算平均汉明距离，使用最低的几个密钥长度，按类似第三题的思路遍历找到密钥</p>
<p>4.MTC3CrackingSHA1-HashedPasswords<br><a href="https://www.mysterytwisterc3.org/en/challenges/level-2/cracking-sh" target="_blank" rel="noopener">https://www.mysterytwisterc3.org/en/challenges/level-2/cracking-sh</a> a1-hashed-passwords<br>以上网址的题目</p>
<p>题目大意：更具键盘的按键与密码输入下的限制条件和对应的sha1值判断输入的password<br>思路:题目给了sha1值和限制条件，遍历可能的密钥和sha1对照即可</p>
<p><img src="https://img-blog.csdnimg.cn/20191020012359251.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMDI2MjE5,size_16,color_FFFFFF,t_70" alt="题目"></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><h4 id="1-week1"><a href="#1-week1" class="headerlink" title="1.week1"></a>1.week1</h4><pre><code class="python">import sys
from operator import methodcaller
import re


def main():
    cypherTexts = []
    # cyphertext 1 (0)
    cypherTexts.append(
        &quot;315c4eeaa8b5f8aaf9174145bf43e1784b8fa00dc71d885a804e5ee9fa40b16349c146fb778cdf2d3aff021dfff5b403b510d0d0455468aeb98622b137dae857553ccd8883a7bc37520e06e515d22c954eba5025b8cc57ee59418ce7dc6bc41556bdb36bbca3e8774301fbcaa3b83b220809560987815f65286764703de0f3d524400a19b159610b11ef3e&quot;)
    # cyphertext 2 (1)
    cypherTexts.append(
        &quot;234c02ecbbfbafa3ed18510abd11fa724fcda2018a1a8342cf064bbde548b12b07df44ba7191d9606ef4081ffde5ad46a5069d9f7f543bedb9c861bf29c7e205132eda9382b0bc2c5c4b45f919cf3a9f1cb74151f6d551f4480c82b2cb24cc5b028aa76eb7b4ab24171ab3cdadb8356f&quot;)
    # cyphertext 3 (2)
    cypherTexts.append(
        &quot;32510ba9a7b2bba9b8005d43a304b5714cc0bb0c8a34884dd91304b8ad40b62b07df44ba6e9d8a2368e51d04e0e7b207b70b9b8261112bacb6c866a232dfe257527dc29398f5f3251a0d47e503c66e935de81230b59b7afb5f41afa8d661cb&quot;)
    # cyphertext 4 (3)
    cypherTexts.append(
        &quot;32510ba9aab2a8a4fd06414fb517b5605cc0aa0dc91a8908c2064ba8ad5ea06a029056f47a8ad3306ef5021eafe1ac01a81197847a5c68a1b78769a37bc8f4575432c198ccb4ef63590256e305cd3a9544ee4160ead45aef520489e7da7d835402bca670bda8eb775200b8dabbba246b130f040d8ec6447e2c767f3d30ed81ea2e4c1404e1315a1010e7229be6636aaa&quot;)
    # cyphertext 5 (4)
    cypherTexts.append(
        &quot;3f561ba9adb4b6ebec54424ba317b564418fac0dd35f8c08d31a1fe9e24fe56808c213f17c81d9607cee021dafe1e001b21ade877a5e68bea88d61b93ac5ee0d562e8e9582f5ef375f0a4ae20ed86e935de81230b59b73fb4302cd95d770c65b40aaa065f2a5e33a5a0bb5dcaba43722130f042f8ec85b7c2070&quot;)
    # cyphertext 6 (5)
    cypherTexts.append(
        &quot;32510bfbacfbb9befd54415da243e1695ecabd58c519cd4bd2061bbde24eb76a19d84aba34d8de287be84d07e7e9a30ee714979c7e1123a8bd9822a33ecaf512472e8e8f8db3f9635c1949e640c621854eba0d79eccf52ff111284b4cc61d11902aebc66f2b2e436434eacc0aba938220b084800c2ca4e693522643573b2c4ce35050b0cf774201f0fe52ac9f26d71b6cf61a711cc229f77ace7aa88a2f19983122b11be87a59c355d25f8e4&quot;)
    # cyphertext 7 (6)
    cypherTexts.append(
        &quot;32510bfbacfbb9befd54415da243e1695ecabd58c519cd4bd90f1fa6ea5ba47b01c909ba7696cf606ef40c04afe1ac0aa8148dd066592ded9f8774b529c7ea125d298e8883f5e9305f4b44f915cb2bd05af51373fd9b4af511039fa2d96f83414aaaf261bda2e97b170fb5cce2a53e675c154c0d9681596934777e2275b381ce2e40582afe67650b13e72287ff2270abcf73bb028932836fbdecfecee0a3b894473c1bbeb6b4913a536ce4f9b13f1efff71ea313c8661dd9a4ce&quot;)
    # cyphertext 8 (7)
    cypherTexts.append(
        &quot;315c4eeaa8b5f8bffd11155ea506b56041c6a00c8a08854dd21a4bbde54ce56801d943ba708b8a3574f40c00fff9e00fa1439fd0654327a3bfc860b92f89ee04132ecb9298f5fd2d5e4b45e40ecc3b9d59e9417df7c95bba410e9aa2ca24c5474da2f276baa3ac325918b2daada43d6712150441c2e04f6565517f317da9d3&quot;)
    # cyphertext 9 (8)
    cypherTexts.append(
        &quot;271946f9bbb2aeadec111841a81abc300ecaa01bd8069d5cc91005e9fe4aad6e04d513e96d99de2569bc5e50eeeca709b50a8a987f4264edb6896fb537d0a716132ddc938fb0f836480e06ed0fcd6e9759f40462f9cf57f4564186a2c1778f1543efa270bda5e933421cbe88a4a52222190f471e9bd15f652b653b7071aec59a2705081ffe72651d08f822c9ed6d76e48b63ab15d0208573a7eef027&quot;)
    # cyphertext 10 (9)
    cypherTexts.append(
        &quot;466d06ece998b7a2fb1d464fed2ced7641ddaa3cc31c9941cf110abbf409ed39598005b3399ccfafb61d0315fca0a314be138a9f32503bedac8067f03adbf3575c3b8edc9ba7f537530541ab0f9f3cd04ff50d66f1d559ba520e89a2cb2a83&quot;)
    # cyphertext target (10)
    cypherTexts.append(
        &quot;32510ba9babebbbefd001547a810e67149caee11d945cd7fc81a05e9f85aac650e9052ba6a8cd8257bf14d13e6f0a803b54fde9e77472dbff89d71b57bddef121336cb85ccb8f3315f4b52e301d16e9f52f904&quot;)

    # convert all to ASCII
    cypherTextsDecoded = map(methodcaller(&quot;decode&quot;, &quot;hex&quot;), cypherTexts)

    # chose two to XOR

    crib = &quot;There are two types of cyptography: one that allows the Government to use brute force to break the code, and one that requires the Government to use brute force to break you&quot;
    xorTextNum1 = 6
    xorTextNum2 = 10
    # /end interatcive

    xoredText = strxor(cypherTextsDecoded[xorTextNum1], cypherTextsDecoded[xorTextNum2])

    # loop all individual positions of the XOR-ed crypto (plain) text
    textLength = len(xoredText)
    for i in range(textLength):
        # XOR the substring with the crib
        substrXoredText = xoredText[i:]
        cribDraggedText = strxor(substrXoredText, crib)

    # do an estimated guess wether the text is readable, if so print the guess (in place)
    # if(isreadable(cribDraggedText)):
    #    printCodePos(i, cribDraggedText, textLength, &#39;.&#39;)

    key = strxor(cypherTextsDecoded[xorTextNum1], crib)

    print &quot;Decrypt all messages using the key:&quot;
    for j, cypher in enumerate(cypherTextsDecoded):
        print &quot;[%d] %s&quot; % (j, strxor(cypher, key))


def strxor(a, b):  # xor two strings of different lengths
    if len(a) &gt; len(b):
        return &quot;&quot;.join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a[:len(b)], b)])
    else:
        return &quot;&quot;.join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a, b[:len(a)])])


def isreadable(str):  # check readability (allow only alphanumeric chars and some punctiation)
    return bool(re.search(&#39;^[a-zA-Z0-9\., \&#39;\&quot;\-_\:\(\)]+$&#39;, str))


def printCodePos(i, code, maxLen, filler):  # output the guess in place of the message
    prefix = filler * i
    ln = len(code)
    postfix = filler * (maxLen - i - ln)
    print(&quot;%s%s%s&quot; % (prefix, code, postfix))


main()
</code></pre>
<h4 id="PA1"><a href="#PA1" class="headerlink" title="PA1"></a>PA1</h4><pre><code class="python"># _*_ coding:utf-8 _*_
&quot;&quot;&quot;
@author 
@time: 2019/10/18 9:00
&quot;&quot;&quot;



#pa1 weijiniya like    fprintf(fpOut, &quot;%02X&quot;, ch ^ key[i % KEY_LENGTH]); // ^ is logical XOR


def findindexkey(subarr):  # 该函数可以找出将密文subarr解密成可见字符的所有可能值
    visiable_chars = []  # 可见字符
    for x in range(32, 126):
        visiable_chars.append(chr(x))
    # print(vi)
    test_keys = []  # 用于测试密钥
    ans_keys = []  # 用于结果的返回
    for x in range(0x00, 0xFF):  # 枚举密钥里所有的值
        test_keys.append(x)
        ans_keys.append(x)
    for i in test_keys:  # 对于0x00~0xFF里的每一个数i和subarr里的每个值s异或
        for s in subarr:
            if chr(s ^ i) not in visiable_chars:  # 用i解密s，如果解密后明文不是可见字符，说明i不是密钥
                ans_keys.remove(i)  # 去掉ans_keys里测试失败的密钥
                break
    # print(ans_keys)
    return ans_keys


strmi = &#39;F96DE8C227A259C87EE1DA2AED57C93FE5DA36ED4EC87EF2C63AAE5B9A7EFFD673BE4ACF7BE8923C\
AB1ECE7AF2DA3DA44FCF7AE29235A24C963FF0DF3CA3599A70E5DA36BF1ECE77F8DC34BE129A6CF4D126BF\
5B9A7CFEDF3EB850D37CF0C63AA2509A76FF9227A55B9A6FE3D720A850D97AB1DD35ED5FCE6BF0D138A84C\
C931B1F121B44ECE70F6C032BD56C33FF9D320ED5CDF7AFF9226BE5BDE3FF7DD21ED56CF71F5C036A94D96\
3FF8D473A351CE3FE5DA3CB84DDB71F5C17FED51DC3FE8D732BF4D963FF3C727ED4AC87EF5DB27A451D47E\
FD9230BF47CA6BFEC12ABE4ADF72E29224A84CDF3FF5D720A459D47AF59232A35A9A7AE7D33FB85FCE7AF5\
923AA31EDB3FF7D33ABF52C33FF0D673A551D93FFCD33DA35BC831B1F43CBF1EDF67F0DF23A15B963FE5DA\
36ED68D378F4DC36BF5B9A7AFFD121B44ECE76FEDC73BE5DD27AFCD773BA5FC93FE5DA3CB859D26BB1C63C\
ED5CDF3FE2D730B84CDF3FF7DD21ED5ADF7CF0D636BE1EDB79E5D721ED57CE3FE6D320ED57D469F4DC27A8\
5A963FF3C727ED49DF3FFFDD24ED55D470E69E73AC50DE3FE5DA3ABE1EDF67F4C030A44DDF3FF5D73EA250\
C96BE3D327A84D963FE5DA32B91ED36BB1D132A31ED87AB1D021A255DF71B1C436BF479A7AF0C13AA14794&#39;
arr = []  # 密文，每个元素为字符的ascii码
for x in range(0, len(strmi), 2):
    arr.append(int(strmi[x:2 + x], 16))

for keylen in range(1, 14):  # 枚举密钥的长度1~14
    for index in range(0, keylen):  # 对密钥里的第index个进行测试
        subarr = arr[index::keylen]  # 每隔keylen长度提取密文的内容，提取出来的内容都被密文的第index个加密
        ans_keys = findindexkey(subarr)  # 找出密钥中第index个的可能的值
        print(&#39;keylen=&#39;, keylen, &#39;index=&#39;, index, &#39;keys=&#39;, ans_keys)
        if ans_keys:  # 如果密钥第index个有可能存在，尝试用密钥的index个去解密文
            ch = []
            for x in ans_keys:
                ch.append(chr(x ^ subarr[0]))
            print(ch)
# 运行到这里，观察输出可以发现，密钥长度为7时有解
print(&#39;###############&#39;)
import string


def findindexkey2(subarr):  # 再造一个函数筛选密钥
    test_chars = string.ascii_letters + string.digits + &#39;,&#39; + &#39;.&#39; + &#39; &#39;  # 将检查的字符改为英文+数字+逗号+句号+空格
    # print(test_chars)
    test_keys = []  # 用于测试密钥
    ans_keys = []  # 用于结果的返回
    for x in range(0x00, 0xFF):  # 枚举密钥里所有的值
        test_keys.append(x)
        ans_keys.append(x)
    for i in test_keys:  # 对于0x00~0xFF里的每一个数i和substr里的每个值s异或
        for s in subarr:
            if chr(s ^ i) not in test_chars:  # 用i解密s，如果解密后不是英文、数字、逗号、句号、空格，说明i不是密钥
                ans_keys.remove(i)  # 去掉ans_keys里测试失败的密钥
                break
    # print(ans_keys)
    return ans_keys


vigenerekeys = []  # 维基尼尔密码的密钥
for index in range(0, 7):  # 已经知道密钥长度是7
    subarr = arr[index::7]
    vigenerekeys.append(findindexkey2(subarr))
print(vigenerekeys)  # 输出的是[[186], [31], [145], [178], [83], [205], [62]].

print(&quot;#########&quot;)
ming = &#39;&#39;
for i in range(0, len(arr)):
    ming = ming + chr(arr[i] ^ vigenerekeys[i % 7][0])
print(ming)


</code></pre>
<h4 id="SET1"><a href="#SET1" class="headerlink" title="SET1"></a>SET1</h4><p>1</p>
<pre><code class="python"># _*_ coding:utf-8 _*_
&quot;&quot;&quot;
@author km
@time: 2019/10/18 9:01
&quot;&quot;&quot;

import base64

def hex_to_base64(hexString):
    return base64.b64encode(hexString.decode(&#39;hex&#39;))

string=&quot;49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d&quot;
print (hex_to_base64(string))</code></pre>
<p>2</p>
<pre><code class="python"># _*_ coding:utf-8 _*_
&quot;&quot;&quot;
@author km
@time: 2019/10/18 9:08
&quot;&quot;&quot;

import string
import re

def xor_strings(xs,ys):
    return &quot;&quot;.join(chr(ord(x) ^ ord(y)) for x, y in zip(xs, ys))

if __name__ == &#39;__main__&#39;:
    string1=&#39;1c0111001f010100061a024b53535009181c&#39;
    string2=&#39;686974207468652062756c6c277320657965&#39;
    hex_string1=string1.encode(&#39;utf-8&#39;).decode(&#39;hex&#39;)  #转化为utf-8 异或
    hex_string2=string2.encode(&#39;utf-8&#39;).decode(&#39;hex&#39;)
    result=xor_strings(hex_string1,hex_string2).encode(&#39;hex&#39;) #hex输出
    print (result)
</code></pre>
<p> 3</p>
<pre><code class="python">#coding=utf-8
import re
str=&quot;1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736&quot;
score=0#max
for i in range(0,129):
    tmp=[]
    for j in re.findall(&quot;.{2}&quot;,str):#任意两个字符的字符串
        tmp += chr(i^int(j,16))
    tmpstr = &quot;&quot;.join(tmp)
    num=0
    for j in range(0,len(tmpstr)):
        if tmpstr[j]&gt;=&#39;a&#39;and tmpstr[j]&lt;=&#39;z&#39;:#or tmpstr[j]&gt;=&#39;A&#39;and tmpstr[j]&lt;=&#39;Z&#39;:
            num+=1
    if num&gt;score:
        #print tmpstr
        score=num#用于更新用
        ansstr=tmpstr
        key=chr(i)
print key
print ansstr</code></pre>
<p>4</p>
<pre><code class="python">#coding=utf-8
import re
#with open(&quot;ex4.txt&quot;) as fp:
#wenben=[i for i in open(&quot;ex4.txt&quot;).readlines()]
wenben=[]
for i in open(&quot;4.txt&quot;,&quot;r&quot;).readlines():
    wenben+=[i.replace(&quot;\n&quot;,&quot;&quot;)] #序列相加  #同第三题
score=0
for k in wenben:
    for i in range(0,129):
        tmp=[]
        for j in re.findall(&quot;.{2}&quot;,k):#任意两个字符的字符串
            tmp += chr(i^int(j,16))
        tmpstr = &quot;&quot;.join(tmp)
        num=0
        num=len(re.findall(r&#39;[a-zA-Z ]&#39;,tmpstr))#一定注意不要落下空格
        if num&gt;score:
            score=num#用于更新用
            ansstr=tmpstr
            c=k
            key=chr(i)
print c
print key
print ansstr</code></pre>
<p>5</p>
<pre><code class="python"># -*- coding: utf-8 -*-

def xor_repeat_key(key,string):
    key_len=len(key)
    result=&#39;&#39;
    str_result=&#39;&#39;
    for index,ch in enumerate(string):
        n=index%key_len#一组组加密
        b=chr(ord(key[n])^ord(ch))
        str_result+=b
    return str_result


def main():
    string1=&#39;Burning \&#39;em, if you ain\&#39;t quick and nimble\nI go crazy when I hear a cymbal&#39;
    key=&#39;ICE&#39;
    print xor_repeat_key(key,string1).encode(&#39;hex&#39;)


if __name__ == &#39;__main__&#39;:
    main()</code></pre>
<p>6</p>
<pre><code class="python">#coding:utf-8
import re
import base64
with open(&quot;6.txt&quot;,&quot;r&quot;) as fp:
    wenben=[base64.b64decode(i) for i in fp.readlines()]
wenben=&quot;&quot;.join(wenben)

def english_test(sentence):#字母频率
    score = 0
    freqs = {
        &#39;a&#39;: 0.0651738, &#39;b&#39;: 0.0124248, &#39;c&#39;: 0.0217339,
        &#39;d&#39;: 0.0349835, &#39;e&#39;: 0.1041442, &#39;f&#39;: 0.0197881,
        &#39;g&#39;: 0.0158610, &#39;h&#39;: 0.0492888, &#39;i&#39;: 0.0558094,
        &#39;j&#39;: 0.0009033, &#39;k&#39;: 0.0050529, &#39;l&#39;: 0.0331490,
        &#39;m&#39;: 0.0202124, &#39;n&#39;: 0.0564513, &#39;o&#39;: 0.0596302,
        &#39;p&#39;: 0.0137645, &#39;q&#39;: 0.0008606, &#39;r&#39;: 0.0497563,
        &#39;s&#39;: 0.0515760, &#39;t&#39;: 0.0729357, &#39;u&#39;: 0.0225134,
        &#39;v&#39;: 0.0082903, &#39;w&#39;: 0.0171272, &#39;x&#39;: 0.0013692,
        &#39;y&#39;: 0.0145984, &#39;z&#39;: 0.0007836, &#39; &#39;: 0.1918182}
    for x in sentence.lower():
        if x in freqs:
            score += freqs[x]
    return score

def hanming(x,y):
    num=0
    for i in range(0,len(x)):
        t=ord(x[i])^ord(y[i])
        while t:
        if t&amp;1 : num+=1
        t&gt;&gt;=1
    return num

def thechar(st1):
    score = 0
    for i in range(0, 255):
        tmp = []
        for j in range(0,len(st1)):  # 任意两个字符的字符串
            tmp += chr(i ^ int(st1[j],16))
        tmpstr = &quot;&quot;.join(tmp)

        #num=len(re.findall(r&#39;[a-zA-Z ,\.;?!:]&#39;,tmpstr))  #&#39;[a-zA-Z ,\.?!:;]&#39;
        num=english_test(tmpstr)
        if num &gt; score:
            score = num  # 用于更新用
            key = chr(i)
            #print key,score
    return key


ans = []
for i in range(1,41):
    str1=[]
    str2=[]
    str3=[]
    str4=[]
    for j in range(0,i): str1+=[wenben[j]]
    for j in range(i,2*i): str2+=[wenben[j]]
    for j in range(2*i,3*i): str3+=[wenben[j]]
    for j in range(3*i,4*i): str4+=[wenben[j]]
    str1=&quot;&quot;.join(str1)
    str2=&quot;&quot;.join(str2)
    str3=&quot;&quot;.join(str3)
    str4=&quot;&quot;.join(str4)
    x1=float(hanming(str1,str2))/i
    x2=float(hanming(str2,str3))/i
    x3=float(hanming(str3,str4))/i
    x4=float(hanming(str1,str4))/i
    x5=float(hanming(str1,str3))/i
    x6=float(hanming(str2,str4))/i
    aa=(x1+x2+x3+x4+x5+x6)/6
    ans+=[(i,aa)]
ans.sort(lambda x,y:cmp(x[1],y[1]))
#print &quot;hello\n&quot;
for i in range(len(ans)):
    print ans[i][0],ans[i][1]
#print len(wenben)
#print len(wenben)%29
wenben=wenben.encode(&#39;hex&#39;)

block=[re.findall(r&#39;(.{2})&#39;,z)  for z in re.findall(r&#39;(.{58})&#39;,wenben)]#29



keyy = []
for i in range(0,29):
    tmp=[]
    for j in range(0,len(block)):
        tmp+=[block[j][i]]
    keyy+=[thechar(tmp)]
keyy=&quot;&quot;.join(keyy)

print &quot;hello\n&quot;
print keyy
print &quot;hello\n&quot;
keyy=keyy*10000

wenben=wenben.decode(&#39;hex&#39;)
an=[]
for i in range(0,len(wenben)):
    an+=[chr(ord(wenben[i])^ord(keyy[i]))]
an=&quot;&quot;.join(an)
print an
    ```

#### 4 keyboard
```python
# _*_ coding:utf-8 _*_
&quot;&quot;&quot;
@author km
@time: 2019/10/18 11:34
&quot;&quot;&quot;
#暴力破解
import re
from Crypto.Hash import SHA
import hashlib
import itertools
import datetime
starttime = datetime.datetime.now()
hash1=&quot;67ae1a64661ac8b4494666f58c4822408dd0a3e4&quot;
str1=&quot;QqWw%58(=0Ii*+nN&quot;
str2=[[&#39;Q&#39;, &#39;q&#39;],[ &#39;W&#39;, &#39;w&#39;],[ &#39;%&#39;, &#39;5&#39;], [&#39;8&#39;, &#39;(&#39;],[ &#39;=&#39;, &#39;0&#39;], [&#39;I&#39;, &#39;i&#39;], [&#39;*&#39;, &#39;+&#39;], [&#39;n&#39;, &#39;N&#39;]]
def sha_encrypt(str):
    sha = hashlib.sha1(str)
    encrypts = sha.hexdigest()
    return encrypts
st3=&quot;0&quot;*8
str4=&quot;&quot;
str3=list(st3)
for a in range(0,2):
    str3[0]=str2[0][a]
    for b in range(0,2):
        str3[1]=str2[1][b]
        for c in range(0,2):
            str3[2]=str2[2][c]
            for d in range(0,2):
            str3[3] = str2[3][d]
            for e in range(0,2):
                str3[4] = str2[4][e]
                for f in range(0,2):
                    str3[5] = str2[5][f]
                    for g in range(0,2):
                        str3[6] = str2[6][g]
                        for h in range(0,2):
                            str3[7] = str2[7][h]
                            newS=&quot;&quot;.join(str3)
                            for i in itertools.permutations(newS, 8):
                                str4 = sha_encrypt(&quot;&quot;.join(i))
                                if str4==hash1:
                                    print &quot;&quot;.join(i)
                                    endtime = datetime.datetime.now()
                                    print (endtime - starttime).seconds
                                    exit(0)
</code></pre>

  </article>
  
    
<div class="nexmoe-post-copyright">
<i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
<strong>Author：</strong>kmm<br>
<strong>Link：</strong><a href="http://yoursite.com/2019/11/13/crypto-exper1/" title="http://yoursite.com/2019/11/13/crypto-exper1/" target="_blank" rel="noopener">http://yoursite.com/2019/11/13/crypto-exper1/</a><br>

  <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可

</div>


  
  <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.5.0/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.5.0/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '80b2453b6d5f37ad6225',
        clientSecret: '43e99fa852795c9a7b3eb924b2558c64b84bbdeb',
        id: window.location.pathname,
        repo: 'nexmoe.github.io',
        owner: 'nexmoe',
        admin: 'nexmoe'
    })
    gitalk.render('gitalk')
</script>
</section>
</div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/js/mdui.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
 
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>


 
    <script src="https://cdn.jsdelivr.net/npm/smoothscroll-for-websites@1.4.9/SmoothScroll.min.js"></script>


<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="/js/app.js?v=1573616268190"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.1.0/lazysizes.min.js"></script>


    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/xtaodada/xtaodada.github.io@0.0.2/copy.js"></script>



  





</body>

</html>
